# 🚀 分布式短链接监控平台 (LinkTracker) 项目设计文档

## 一、 项目定位

一个面向个人与小微企业的**高并发、高性能**长链接缩短与流量监控平台。通过 Redis 缓存与异步处理，实现毫秒级的重定向响应。

------

## 二、 后端视角：架构与核心逻辑 (The Core)

后端是整个系统的“大脑”，负责处理高并发请求、保证数据一致性以及性能优化。

### 1. 核心流程逻辑

#### A. 长链转短链 (Write 流程)

1. **参数校验**：校验前端传来的 URL 格式是否合法。
2. **唯一 ID 生成**：通过 **Redis `INCR`** 拿到自增数字 ID。
3. **进制转换**：将 10 进制 ID 转为 **Base62 进制** 字符串（短码）。
4. **数据持久化**：将映射关系存入 MySQL。
5. **缓存同步**：将 `短码 -> 长链` 存入 **Redis**，并同步更新 **布隆过滤器**。

#### B. 短链重定向 (Read 流程 - 极致性能要求)

1. **入口拦截**：Controller 接收到短码请求。
2. **非法过滤**：查询 **布隆过滤器**，若不存在直接返回 404（保护数据库）。
3. **缓存检索**：从 **Redis** 获取长链接。
4. **异步统计**：利用 **Redis `HINCRBY`** 记录点击数，并异步记录访问者 IP、设备等信息（不阻塞跳转）。
5. **重定向**：返回 HTTP **302** 状态码及目标 Location。

### 2. Redis 关键应用设计

| **功能模块**      | **Redis 数据结构**        | **作用描述**                                    |
| ----------------- | ------------------------- | ----------------------------------------------- |
| **分布式发号器**  | `String (Atomic Counter)` | 利用 `INCR` 保证短码唯一且生成性能极高。        |
| **重定向映射**    | `String (Key-Value)`      | 存储 `short_code -> long_url`，实现 O(1) 查询。 |
| **接口防刷/限流** | `ZSet (Sliding Window)`   | 限制同一 IP 在 1 分钟内的转换次数。             |
| **实时点击统计**  | `Hash`                    | 存储每个短码的 PV（访问量）。                   |
| **独立访客统计**  | `HyperLogLog`             | 存储每个短码的 UV（独立访客数），极省空间。     |

------

## 三、 前端视角：交互与可视化 (The Face)

前端不仅是输入框，更是数据的展示终端，决定了项目的“专业感”。

### 1. 核心页面规划

#### A. 转换工作台 (Home Page)

- **输入组件**：Ant Design/Element Plus 的大号输入框，支持粘贴长链接。
- **转换反馈**：点击后显示 Loading 动画，成功后弹出短链接结果。
- **快捷功能**：一键复制、生成对应的二维码预览。

#### B. 链接管理后台 (Management)

- **数据表格**：展示已生成的链接列表（原始链接截断显示、短链接、创建时间、累计点击量）。
- **操作按钮**：编辑（修改指向地址）、删除、跳转到详情。

#### C. 数据可视化报表 (Analytics)

- **实时看板**：
  - **总览卡片**：今日点击数、昨日点击数、累计用户数（UV）。
  - **趋势折线图 (ECharts)**：展示 24 小时或 7 天内的流量波动。
  - **地域热力图**：通过 IP 转化，展示访问者来自哪些省份。
  - **终端画像**：饼图展示 Chrome/Safari、手机/PC 的占比。

### 2. 用户交互逻辑

- **响应式设计**：适配手机端，方便在手机上点击转换。
- **空状态处理**：没有数据时显示占位图。
- **反馈机制**：复制成功、网络错误等均有明显的 Toast 提示。

------

## 四、 为什么这份设计能写进简历？

1. **解决痛点**：避开了传统数据库查询在高并发下的 IO 瓶颈。
2. **技术栈深**：涵盖了 Redis 的多种高级用法（布隆过滤器、HyperLogLog、Lua 脚本预减等）。
3. **架构思维**：体现了**读写分离**、**异步统计**和**多级过滤**的设计思想。
4. **完整性**：从简单的输入到复杂的图表展示，是一个完整的 **SaaS 产品雏形**。

------

## 五、 下一步：建议的开发顺序

1. **Step 1**: 搭建后端 Spring Boot 骨架，实现最简单的 `10进制转62进制` 逻辑。
2. **Step 2**: 接入 Redis，实现“存入一个短码，访问它能跳转”的最小闭环。
3. **Step 3**: 编写简单的 Vue/Element 页面，实现前后端联调。
4. **Step 4**: 逐步加入布隆过滤器、数据统计和 ECharts 图表。